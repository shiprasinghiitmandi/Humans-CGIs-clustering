# CpG clustering and methylation maps formation
CpG island sequences from each chromosome were converted into string of dy-dx numerical values. All the possible permutations and combinations of these CGIs(CpG Islands) were compared among each other to find similiarity. Since we had only two variables(dy and dx) in our CGI sequence, we went for developing a linear correlation between every possible CGI pair by calculating Pearson correlation coefficient. We went for calculating corelation coefficients between all possible CGI sequence pairs for a pair of chromosomes individually, followed by their distance matrix formation, linkage matrix formation and hierarchical clustering. Since the task of processing files of all chromsomsomes altogether was highly memeory intensive, therefore we made all possible pairs of chromsomes and processed each pair to produce an individual distance matrix. This way a total of 300 chromosome pairs(emerging from 24 chromosomes) and 300 distance matrices were obtained which were next combined to make a single distance matrix for a single percentile of CGI sequences.
# Pearson calculation, distance matrix formation and hierarchical clustering
Flipped_comp_matrix.py code is used to process the file containing CGIs from any of the chromosome pair which first calculates pearson correlation berween different pairs of CGIs by shifting the shorter sequence over the longer one by 2 bp(as min dy is 2bp,CGI starts with dy and we want like elements from both the CGIs to be overlapping at a time). Next, the sequence is also flipped to calculate all the possible pearsons in flipped format, too(This is done to avoid any chances of missing a better alignment of two CGIs over each other). Once this process is done, the highest pearson calculated between the sequences is considered as best score/best pearson between the sequences and the position where it got recorded is the 'best shift' position. This is done for all possible sequence pairs. Next, distance is calculated for each sequence pair using best pearson score between all sequence pairs. distance matrix is generated and saved(will be used further) followed by linkage matrix formation which is next used to perform Agglomerative Hierarchical clustering where each instance is considered as a seperate cluster in starting and then getsmerged with the closest cluster to result into single cluster.
We performed the same analysis for the files of all 300 chromosome pairs and then resulting distance matrices from them were compiled using 1tillY_distance_combined.py code.
After combining all the distance matrices together, we got one distance matrix for all chromosomes 1 till Y.
We next went for cluster cutting using the code half_dist_cluster_cutting.py, which used only half of this final distance matrix to form clusters at the the cut-point defined.
# Cluster-wise sequence alignment
flipped_align2.py is the code which can be used to align all the CGIs within the cluster based upon the best pearson score calculation at their best shifts. The algorithm to calculate best pearson correlation betwen all possible sequence pairs is same as we did in the clustering clogoritm before producing the distance matrices, but this time the scores were calculated for the sequences within the clusters and were recorded alongwith the best shifts and the flip information so that they can be aligned appropriately.
flipped_align3.py code was used to align all the sequences within the clusters using the recorded information from flipped_align2.py. Multiple cases were considered while aligning the CGIs within each cluster, each of which is mentioned in the code.
